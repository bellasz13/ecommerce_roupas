<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TrendStore - Masculino</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>

<header class="main-header">
  <div class="menu-icon">
    <a href="perfil.html">
      <img src="imagens/icones/user.png" alt="Menu" width="28" height="28">
    </a>
  </div>

  <div class="logo">
    <a href="index.html">TrendStore</a>
  </div>

  <div class="header-icon">
    <a href="favorito.html">
      <img src="imagens/icones/favorito.png" alt="Favoritos" width="28">
    </a>
    <a href="carrinho.html">
      <img src="imagens/icones/carrinho.png" alt="Carrinho de compras" width="28" height="28">
    </a>
  </div>
</header>

<main>
  <h1 class="categoria-masculino">Roupas Masculinas</h1>

  <section class="produtos-masculino">

    <a href="produto.html?id=101" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i1.jpg" alt="Camisa Linho" width="200">
      <h3>Camisa Linho</h3>
      <div class="preco">179,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=102" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i2.jpg" alt="Calça Sarja Bege" width="200">
      <h3>Calça Sarja Bege</h3>
      <div class="preco">229,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=103" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i3.jpg" alt="Blusa Tricot Azul" width="200">
      <h3>Blusa Tricot Azul</h3>
      <div class="preco">259,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=104" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i4.jpg" alt="Blusa Tricot OFF" width="200">
      <h3>Blusa Tricot OFF</h3>
      <div class="preco">259,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=105" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i5.jpg" alt="Bermuda Sarja Bege" width="200">
      <h3>Bermuda Sarja Bege</h3>
      <div class="preco">159,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=106" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i6.jpg" alt="Camisa Listrada" width="200">
      <h3>Camisa Listrada</h3>
      <div class="preco">199,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=107" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i7.jpg" alt="Camiseta Pastel" width="200">
      <h3>Camiseta Pastel</h3>
      <div class="preco">179,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=108" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i8.jpg" alt="Regata Bege" width="200">
      <h3>Regata Bege</h3>
      <div class="preco">109,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=109" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i9.jpg" alt="Conjunto BIC Azul" width="200">
      <h3>Conjunto BIC Azul</h3>
      <div class="preco">389,90</div>
      <div class="parcelas">ou 3x sem juros</div>
    </a>

    <a href="produto.html?id=110" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i10.jpg" alt="Camisa Boxy Pastel" width="200">
      <h3>Camisa Boxy Pastel</h3>
      <div class="preco">129,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=111" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i11.jpg" alt="Camisa Oliva" width="200">
      <h3>Camisa Oliva</h3>
      <div class="preco">219,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=112" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i12.jpg" alt="Camisa Linho - Ramos" width="200">
      <h3>Camisa Linho - Ramos</h3>
      <div class="preco">179,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=113" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i13.jpg" alt="Camisa Gaivotas" width="200">
      <h3>Camisa Gaivotas</h3>
      <div class="preco">169,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=114" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i14.jpg" alt="Calça Sarja Marrom" width="200">
      <h3>Calça Sarja Marrom</h3>
      <div class="preco">189,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=115" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i15.jpg" alt="Camisa Zebra" width="200">
      <h3>Camisa Zebra</h3>
      <div class="preco">89,90</div>
      <div class="parcelas">ou 1x sem juros</div>
    </a>

    <a href="produto.html?id=116" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-masc/i16.jpg" alt="Jorts" width="200">
      <h3>Jorts</h3>
      <div class="preco">109,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

  </section>
</main>

<script>
  function getFavoritos() {
    const salvo = localStorage.getItem('favoritosTrendStore');
    return salvo ? JSON.parse(salvo) : [];
  }

  function salvarFavoritos(lista) {
    localStorage.setItem('favoritosTrendStore', JSON.stringify(lista));
  }

  function toggleFavorito(produtoId) {
    const favs = getFavoritos();
    const index = favs.indexOf(produtoId);

    if (index === -1) {
      favs.push(produtoId);
    } else {
      favs.splice(index, 1);
    }

    salvarFavoritos(favs);
    return favs.includes(produtoId);
  }

  function salvarFavoritoDetalhado(id, nome, precoTexto, imagem, parcelamento) {
    const salvo = localStorage.getItem('favoritosDetalhadosTrendStore');
    const lista = salvo ? JSON.parse(salvo) : [];
    const existe = lista.find(item => item.id === id);
    if (!existe) {
      lista.push({ id, nome, precoTexto, imagem, parcelamento });
      localStorage.setItem('favoritosDetalhadosTrendStore', JSON.stringify(lista));
    }
  }

  function getCarrinho() {
    const salvo = localStorage.getItem('carrinhoTrendStore');
    return salvo ? JSON.parse(salvo) : [];
  }

  function salvarCarrinho(lista) {
    localStorage.setItem('carrinhoTrendStore', JSON.stringify(lista));
  }

  function adicionarAoCarrinhoSimples(produtoId, nome, preco, imagem) {
    const carrinho = getCarrinho();
    const index = carrinho.findIndex(item => item.id === produtoId);

    if (index === -1) {
      carrinho.push({
        id: produtoId,
        nome,
        preco,
        imagem,
        quantidade: 1
      });
    } else {
      carrinho[index].quantidade += 1;
    }

    salvarCarrinho(carrinho);
  }

  // NOVO: ao carregar a página, ajustar ícones conforme localStorage
  document.addEventListener('DOMContentLoaded', function () {
    const favoritos = getFavoritos();

    document.querySelectorAll('.produto-card').forEach(card => {
      const url = new URL(card.href, window.location.origin);
      const id  = url.searchParams.get('id');
      const heart = card.querySelector('.icon-heart');
      if (!heart) return;

      heart.src = favoritos.includes(id)
        ? 'imagens/icones/favorito-cheio.png'
        : 'imagens/icones/favorito-preto.png';
    });
  });

  // clique nos ícones (continua igual)
  document.addEventListener('click', function (event) {
    const heart = event.target.closest('.icon-heart');
    const cart  = event.target.closest('.icon-cart');

    if (heart) {
      event.preventDefault();
      event.stopPropagation();

      const logado = localStorage.getItem('usuarioLogado');
      if (logado !== 'true') {
        alert('Você precisa estar logado para favoritar produtos.');
        window.location.href = 'login.html';
        return;
      }

      const card = heart.closest('.produto-card');
      const url  = new URL(card.href, window.location.origin);
      const id   = url.searchParams.get('id');

      const nome = card.querySelector('h3').textContent;
      const precoTexto = card.querySelector('.preco').textContent;
      const imagem = card.querySelector('img:not(.icon-heart):not(.icon-cart)').src;
      const parcelamento = card.querySelector('.parcelas')
        ? card.querySelector('.parcelas').textContent
        : '';

      const marcado = toggleFavorito(id);
      heart.src = marcado
        ? 'imagens/icones/favorito-cheio.png'
        : 'imagens/icones/favorito-preto.png';

      if (marcado) {
        salvarFavoritoDetalhado(id, nome, precoTexto, imagem, parcelamento);
      } else {
        const salvo = localStorage.getItem('favoritosDetalhadosTrendStore');
        let lista = salvo ? JSON.parse(salvo) : [];
        lista = lista.filter(item => item.id !== id);
        localStorage.setItem('favoritosDetalhadosTrendStore', JSON.stringify(lista));
      }

      alert(
        marcado
          ? 'Adicionado aos favoritos!'
          : 'Removido dos favoritos!'
      );
    }

    if (cart) {
      event.preventDefault();
      event.stopPropagation();

      const card = cart.closest('.produto-card');
      const url  = new URL(card.href, window.location.origin);
      const id   = url.searchParams.get('id');
      const nome = card.querySelector('h3').textContent;
      const precoTexto = card.querySelector('.preco').textContent
        .replace('.', '')
        .replace(',', '.');
      const preco  = Number(precoTexto);
      const imagem = card.querySelector('img:not(.icon-heart):not(.icon-cart)').src;

      adicionarAoCarrinhoSimples(id, nome, preco, imagem);
      alert('Produto adicionado ao carrinho!');
    }
  });
</script>

</body>
</html>

