<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TrendStore - Feminino</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<header class="main-header">
  <div class="menu-icon">
    <a href="perfil.html">
      <img src="imagens/icones/user.png" alt="Menu" width="28" height="28">
    </a>
  </div>

  <div class="logo">
    <a href="index.html">TrendStore</a>
  </div>

  <div class="header-icon">
    <a href="favorito.html">
      <img src="imagens/icones/favorito.png" alt="Favoritos" width="28">
    </a>
    <a href="carrinho.html">
      <img src="imagens/icones/carrinho.png" alt="Carrinho de compras" width="28" height="28">
    </a>
  </div>
</header>

<main>
  <h1 class="categoria-feminino">Roupas Femininas</h1>

  <section class="produtos-feminino">

    <a href="produto.html?id=1" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i1.jpg" alt="Trio OFF" width="200">
      <h3>Trio OFF</h3>
      <div class="preco">779,90</div>
      <div class="parcelas">ou 7x sem juros</div>
    </a>

    <a href="produto.html?id=2" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i2.jpg" alt="Conjunto White" width="200">
      <h3>Conjunto White</h3>
      <div class="preco">429,90</div>
      <div class="parcelas">ou 4x sem juros</div>
    </a>

    <a href="produto.html?id=3" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i3.png" alt="Vestido Amarelo Terroso" width="200">
      <h3>Vestido Amarelo Terroso</h3>
      <div class="preco">1199,90</div>
      <div class="parcelas">ou 10x sem juros</div>
    </a>

    <a href="produto.html?id=4" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i4.jpg" alt="Vestido Burnet Red" width="200">
      <h3>Vestido Burnet Red</h3>
      <div class="preco">1559,90</div>
      <div class="parcelas">ou 10x sem juros</div>
    </a>

    <a href="produto.html?id=5" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i5.jpg" alt="Regata Godê Pink" width="200">
      <h3>Regata Godê Pink</h3>
      <div class="preco">159,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=6" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i6.jpg" alt="Conjunto Red Blood" width="200">
      <h3>Conjunto Red Blood</h3>
      <div class="preco">549,90</div>
      <div class="parcelas">ou 5x sem juros</div>
    </a>

    <a href="produto.html?id=7" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i7.jpg" alt="Conjunto Grey" width="200">
      <h3>Conjunto Grey</h3>
      <div class="preco">479,90</div>
      <div class="parcelas">ou 4x sem juros</div>
    </a>

    <a href="produto.html?id=8" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i8.jpg" alt="Vestido Bege Plissado" width="200">
      <h3>Vestido Bege Plissado</h3>
      <div class="preco">1249,90</div>
      <div class="parcelas">ou 10x sem juros</div>
    </a>

    <a href="produto.html?id=9" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i9.jpg" alt="Vestido Pink Flower" width="200">
      <h3>Vestido Pink Flower</h3>
      <div class="preco">1789,90</div>
      <div class="parcelas">ou 10x sem juros</div>
    </a>

    <a href="produto.html?id=10" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i10.jpg" alt="Vestido Yellow Butter" width="200">
      <h3>Vestido Yellow Butter</h3>
      <div class="preco">829,90</div>
      <div class="parcelas">ou 8x sem juros</div>
    </a>

    <a href="produto.html?id=11" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i11.jpg" alt="Macacão Ombro Único" width="200">
      <h3>Macacão Ombro Único</h3>
      <div class="preco">669,90</div>
      <div class="parcelas">ou 6x sem juros</div>
    </a>

    <a href="produto.html?id=12" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i12.png" alt="Conjunto Purple" width="200">
      <h3>Conjunto Purple</h3>
      <div class="preco">409,90</div>
      <div class="parcelas">ou 4x sem juros</div>
    </a>

    <a href="produto.html?id=13" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i13.jpg" alt="Macacão Decote V" width="200">
      <h3>Macacão Decote V</h3>
      <div class="preco">399,90</div>
      <div class="parcelas">ou 3x sem juros</div>
    </a>

    <a href="produto.html?id=14" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i14.jpg" alt="Conjunto Réveillon" width="200">
      <h3>Conjunto Réveillon</h3>
      <div class="preco">489,90</div>
      <div class="parcelas">ou 4x sem juros</div>
    </a>

    <a href="produto.html?id=15" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i15.jpg" alt="Grey Dress" width="200">
      <h3>Grey Dress</h3>
      <div class="preco">839,90</div>
      <div class="parcelas">ou 8x sem juros</div>
    </a>

    <a href="produto.html?id=16" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/roupas-fem/i16.jpg" alt="Vestido Luar" width="200">
      <h3>Vestido Luar</h3>
      <div class="preco">989,90</div>
      <div class="parcelas">ou 9x sem juros</div>
    </a>

  </section>
</main>

<script>
  function getFavoritos() {
    const salvo = localStorage.getItem('favoritosTrendStore');
    return salvo ? JSON.parse(salvo) : [];
  }

  function salvarFavoritos(lista) {
    localStorage.setItem('favoritosTrendStore', JSON.stringify(lista));
  }

  function toggleFavorito(produtoId) {
    const favs = getFavoritos();
    const index = favs.indexOf(produtoId);

    if (index === -1) {
      favs.push(produtoId);
    } else {
      favs.splice(index, 1);
    }

    salvarFavoritos(favs);
    return favs.includes(produtoId);
  }

  function salvarFavoritoDetalhado(id, nome, precoTexto, imagem, parcelamento) {
    const salvo = localStorage.getItem('favoritosDetalhadosTrendStore');
    const lista = salvo ? JSON.parse(salvo) : [];
    const existe = lista.find(item => item.id === id);
    if (!existe) {
      lista.push({ id, nome, precoTexto, imagem, parcelamento });
      localStorage.setItem('favoritosDetalhadosTrendStore', JSON.stringify(lista));
    }
  }

  function getCarrinho() {
    const salvo = localStorage.getItem('carrinhoTrendStore');
    return salvo ? JSON.parse(salvo) : [];
  }

  function salvarCarrinho(lista) {
    localStorage.setItem('carrinhoTrendStore', JSON.stringify(lista));
  }

  function adicionarAoCarrinhoSimples(produtoId, nome, preco, imagem) {
    const carrinho = getCarrinho();
    const index = carrinho.findIndex(item => item.id === produtoId);

    if (index === -1) {
      carrinho.push({
        id: produtoId,
        nome,
        preco,
        imagem,
        quantidade: 1
      });
    } else {
      carrinho[index].quantidade += 1;
    }

    salvarCarrinho(carrinho);
  }

  document.addEventListener('DOMContentLoaded', function () {
    const favoritos = getFavoritos();

    document.querySelectorAll('.produto-card').forEach(card => {
      const url = new URL(card.href, window.location.origin);
      const id  = url.searchParams.get('id');
      const heart = card.querySelector('.icon-heart');
      if (!heart) return;

      heart.src = favoritos.includes(id)
        ? 'imagens/icones/favorito-cheio.png'
        : 'imagens/icones/favorito-preto.png';
    });
  });

  document.addEventListener('click', function (event) {
    const heart = event.target.closest('.icon-heart');
    const cart  = event.target.closest('.icon-cart');

    if (heart) {
      event.preventDefault();
      event.stopPropagation();

      const logado = localStorage.getItem('usuarioLogado');
      if (logado !== 'true') {
        alert('Você precisa estar logado para favoritar produtos.');
        window.location.href = 'login.html';
        return;
      }

      const card = heart.closest('.produto-card');
      const url  = new URL(card.href, window.location.origin);
      const id   = url.searchParams.get('id');

      const nome = card.querySelector('h3').textContent;
      const precoTexto = card.querySelector('.preco').textContent;
      const imagem = card.querySelector('img:not(.icon-heart):not(.icon-cart)').src;
      const parcelamento = card.querySelector('.parcelas')
        ? card.querySelector('.parcelas').textContent
        : '';

      const marcado = toggleFavorito(id);
      heart.src = marcado
        ? 'imagens/icones/favorito-cheio.png'
        : 'imagens/icones/favorito-preto.png';

      if (marcado) {
        salvarFavoritoDetalhado(id, nome, precoTexto, imagem, parcelamento);
      } else {
        const salvo = localStorage.getItem('favoritosDetalhadosTrendStore');
        let lista = salvo ? JSON.parse(salvo) : [];
        lista = lista.filter(item => item.id !== id);
        localStorage.setItem('favoritosDetalhadosTrendStore', JSON.stringify(lista));
      }

      alert(
        marcado
          ? 'Adicionado aos favoritos!'
          : 'Removido dos favoritos!'
      );
    }

    if (cart) {
      event.preventDefault();
      event.stopPropagation();

      const card = cart.closest('.produto-card');
      const url  = new URL(card.href, window.location.origin);
      const id   = url.searchParams.get('id');
      const nome = card.querySelector('h3').textContent;
      const precoTexto = card.querySelector('.preco').textContent
        .replace('.', '')
        .replace(',', '.');
      const preco  = Number(precoTexto);
      const imagem = card.querySelector('img:not(.icon-heart):not(.icon-cart)').src;

      adicionarAoCarrinhoSimples(id, nome, preco, imagem);
      alert('Produto adicionado ao carrinho!');
    }
  });
</script>

</body>
</html>