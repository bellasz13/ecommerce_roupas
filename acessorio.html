<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TrendStore - Acessórios</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<header class="main-header">
  <div class="menu-icon">
    <a href="perfil.html">
      <img src="imagens/icones/user.png" alt="Menu" width="28" height="28">
    </a>
  </div>

  <div class="logo">
    <a href="index.html">TrendStore</a>
  </div>

  <div class="header-icon">
    <a href="favorito.html">
      <img src="imagens/icones/favorito.png" alt="Favoritos" width="28">
    </a>
    <a href="carrinho.html">
      <img src="imagens/icones/carrinho.png" alt="Carrinho de compras" width="28" height="28">
    </a>
  </div>
</header>

<main>
  <h1 class="categoria-acessorios">Acessórios</h1>

  <section class="produtos-acessorios">

    <a href="produto.html?id=201" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i1.jpg" alt="Cinto OFF" width="200">
      <h3>Cinto OFF</h3>
      <div class="preco">59,90</div>
      <div class="parcelas">ou 1x sem juros</div>
    </a>

    <a href="produto.html?id=202" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i2.jpg" alt="Relógio Brown Gold" width="200">
      <h3>Relógio Brown Gold</h3>
      <div class="preco">99,90</div>
      <div class="parcelas">ou 1x sem juros</div>
    </a>

    <a href="produto.html?id=203" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i3.jpg" alt="Dupla - Silver&Gold" width="200">
      <h3>Dupla - Silver&Gold</h3>
      <div class="preco">119,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=204" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i4.jpg" alt="Brinco Informal" width="200">
      <h3>Brinco Informal</h3>
      <div class="preco">49,90</div>
      <div class="parcelas">ou 1x sem juros</div>
    </a>

    <a href="produto.html?id=205" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i5.jpg" alt="Corrente Sun" width="200">
      <h3>Corrente Sun</h3>
      <div class="preco">89,90</div>
      <div class="parcelas">ou 1x sem juros</div>
    </a>

    <a href="produto.html?id=206" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i6.jpg" alt="Brinco Pedras" width="200">
      <h3>Brinco Pedras</h3>
      <div class="preco">79,90</div>
      <div class="parcelas">ou 1x sem juros</div>
    </a>

    <a href="produto.html?id=207" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i7.jpg" alt="Relógio Gold" width="200">
      <h3>Relógio Gold</h3>
      <div class="preco">179,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=208" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i8.jpg" alt="Cinto Couro Bege" width="200">
      <h3>Cinto Couro Bege</h3>
      <div class="preco">149,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=209" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i9.jpg" alt="Bolsa Sunset" width="200">
      <h3>Bolsa Sunset</h3>
      <div class="preco">169,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=210" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i10.jpg" alt="Bolsa Tiracolo" width="200">
      <h3>Bolsa Tiracolo</h3>
      <div class="preco">129,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=211" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i11.jpg" alt="Bolsa Brown" width="200">
      <h3>Bolsa Brown</h3>
      <div class="preco">159,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=212" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i12.jpg" alt="Bolsa Couro Branco" width="200">
      <h3>Bolsa Couro Branco</h3>
      <div class="preco">309,90</div>
      <div class="parcelas">ou 3x sem juros</div>
    </a>

    <a href="produto.html?id=213" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i13.png" alt="Brinco Flower" width="200">
      <h3>Brinco Flower</h3>
      <div class="preco">49,90</div>
      <div class="parcelas">ou 1x sem juros</div>
    </a>

    <a href="produto.html?id=214" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i14.jpg" alt="Anel Pérola" width="200">
      <h3>Anel Pérola</h3>
      <div class="preco">89,90</div>
      <div class="parcelas">ou 1x sem juros</div>
    </a>

    <a href="produto.html?id=215" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i15.jpg" alt="Anel Diamond" width="200">
      <h3>Anel Diamond</h3>
      <div class="preco">239,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

    <a href="produto.html?id=216" class="produto-card">
      <div class="icones-produto">
        <img src="imagens/icones/favorito-preto.png" class="icon-heart" alt="Favoritar">
        <img src="imagens/icones/carrinho-add.png" class="icon-cart" alt="Comprar">
      </div>
      <img src="imagens/acessorios/i16.jpg" alt="Dupla Green" width="200">
      <h3>Dupla Green</h3>
      <div class="preco">139,90</div>
      <div class="parcelas">ou 2x sem juros</div>
    </a>

  </section>
</main>

<script>
  function getFavoritos() {
    const salvo = localStorage.getItem('favoritosTrendStore');
    return salvo ? JSON.parse(salvo) : [];
  }

  function salvarFavoritos(lista) {
    localStorage.setItem('favoritosTrendStore', JSON.stringify(lista));
  }

  function toggleFavorito(produtoId) {
    const favs = getFavoritos();
    const index = favs.indexOf(produtoId);

    if (index === -1) {
      favs.push(produtoId);
    } else {
      favs.splice(index, 1);
    }

    salvarFavoritos(favs);
    return favs.includes(produtoId);
  }

  function salvarFavoritoDetalhado(id, nome, precoTexto, imagem, parcelamento) {
    const salvo = localStorage.getItem('favoritosDetalhadosTrendStore');
    const lista = salvo ? JSON.parse(salvo) : [];
    const existe = lista.find(item => item.id === id);
    if (!existe) {
      lista.push({ id, nome, precoTexto, imagem, parcelamento });
      localStorage.setItem('favoritosDetalhadosTrendStore', JSON.stringify(lista));
    }
  }

  function getCarrinho() {
    const salvo = localStorage.getItem('carrinhoTrendStore');
    return salvo ? JSON.parse(salvo) : [];
  }

  function salvarCarrinho(lista) {
    localStorage.setItem('carrinhoTrendStore', JSON.stringify(lista));
  }

  function adicionarAoCarrinhoSimples(produtoId, nome, preco, imagem) {
    const carrinho = getCarrinho();
    const index = carrinho.findIndex(item => item.id === produtoId);

    if (index === -1) {
      carrinho.push({
        id: produtoId,
        nome,
        preco,
        imagem,
        quantidade: 1
      });
    } else {
      carrinho[index].quantidade += 1;
    }

    salvarCarrinho(carrinho);
  }

  // NOVO: ao carregar a página, ajustar ícones conforme localStorage
  document.addEventListener('DOMContentLoaded', function () {
    const favoritos = getFavoritos();

    document.querySelectorAll('.produto-card').forEach(card => {
      const url = new URL(card.href, window.location.origin);
      const id  = url.searchParams.get('id');
      const heart = card.querySelector('.icon-heart');
      if (!heart) return;

      heart.src = favoritos.includes(id)
        ? 'imagens/icones/favorito-cheio.png'
        : 'imagens/icones/favorito-preto.png';
    });
  });

  // clique nos ícones (continua igual)
  document.addEventListener('click', function (event) {
    const heart = event.target.closest('.icon-heart');
    const cart  = event.target.closest('.icon-cart');

    if (heart) {
      event.preventDefault();
      event.stopPropagation();

      const logado = localStorage.getItem('usuarioLogado');
      if (logado !== 'true') {
        alert('Você precisa estar logado para favoritar produtos.');
        window.location.href = 'login.html';
        return;
      }

      const card = heart.closest('.produto-card');
      const url  = new URL(card.href, window.location.origin);
      const id   = url.searchParams.get('id');

      const nome = card.querySelector('h3').textContent;
      const precoTexto = card.querySelector('.preco').textContent;
      const imagem = card.querySelector('img:not(.icon-heart):not(.icon-cart)').src;
      const parcelamento = card.querySelector('.parcelas')
        ? card.querySelector('.parcelas').textContent
        : '';

      const marcado = toggleFavorito(id);
      heart.src = marcado
        ? 'imagens/icones/favorito-cheio.png'
        : 'imagens/icones/favorito-preto.png';

      if (marcado) {
        salvarFavoritoDetalhado(id, nome, precoTexto, imagem, parcelamento);
      } else {
        const salvo = localStorage.getItem('favoritosDetalhadosTrendStore');
        let lista = salvo ? JSON.parse(salvo) : [];
        lista = lista.filter(item => item.id !== id);
        localStorage.setItem('favoritosDetalhadosTrendStore', JSON.stringify(lista));
      }

      alert(
        marcado
          ? 'Adicionado aos favoritos!'
          : 'Removido dos favoritos!'
      );
    }

    if (cart) {
      event.preventDefault();
      event.stopPropagation();

      const card = cart.closest('.produto-card');
      const url  = new URL(card.href, window.location.origin);
      const id   = url.searchParams.get('id');
      const nome = card.querySelector('h3').textContent;
      const precoTexto = card.querySelector('.preco').textContent
        .replace('.', '')
        .replace(',', '.');
      const preco  = Number(precoTexto);
      const imagem = card.querySelector('img:not(.icon-heart):not(.icon-cart)').src;

      adicionarAoCarrinhoSimples(id, nome, preco, imagem);
      alert('Produto adicionado ao carrinho!');
    }
  });
</script>


</body>
</html>